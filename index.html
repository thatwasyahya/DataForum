<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statistiques des Forums</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
            color: #333;
        }

        header {
            text-align: center;
            padding: 20px;
            background-color: #6c5ce7;
            color: white;
            font-size: 24px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .selectors {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        select {
            padding: 12px 15px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.2s;
            cursor: pointer;
        }

        select:focus {
            outline: none;
            box-shadow: 0 0 10px #6c5ce7;
        }

        #chart-main {
            width: 95%;
            max-width: 1200px;
            margin: 20px auto;
            background: #fff;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .top3{
            padding: 12px 15px;
            font-size: 16px;
            text-align: center;
        }

        #top-charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .top-chart {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .top-chart:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        footer {
            text-align: center;
            padding: 10px;
            margin-top: 20px;
            background-color: #6c5ce7;
            color: white;
            font-size: 14px;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>

<header>Comparaison des Performances des Forums</header>

<div class="selectors">
    <select id="forum-selector-1"></select>
    <select id="forum-selector-2"></select>
</div>

<!-- Conteneur principal pour les graphiques -->
<div id="chart-main"></div>
<div class="top3"><h2>Top 3 Forums</h2></div>
<div id="top-charts-container"></div>

<footer>&copy; 2024 | Statistiques Forums - Outil d'analyse</footer>

<script>
function loadAndCreateCharts() {
    fetch('forum_stats.csv')
        .then(response => response.text())
        .then(data => {
            const rows = data.trim().split('\n').map(row => row.split(','));
            const headers = rows.shift();
            const forumsData = rows.map(row => {
                return headers.reduce((acc, header, index) => {
                    acc[header.trim()] = row[index].trim();
                    return acc;
                }, {});
            });

            const sortedForums = forumsData.sort((a, b) => parseFloat(b['Quality Score (%)']) - parseFloat(a['Quality Score (%)']));

            const forumSelector1 = document.getElementById('forum-selector-1');
            const forumSelector2 = document.getElementById('forum-selector-2');

            forumsData.forEach(forum => {
                const option1 = document.createElement('option');
                const option2 = document.createElement('option');
                option1.value = forum['Forum ID'];
                option1.text = `Forum ${forum['Forum ID']} - Qualité: ${parseFloat(forum['Quality Score (%)']).toFixed(2)}%`;
                option2.value = forum['Forum ID'];
                option2.text = option1.text;

                forumSelector1.appendChild(option1);
                forumSelector2.appendChild(option2);
            });

            forumSelector1.value = sortedForums[0]['Forum ID'];
            forumSelector2.value = sortedForums[1]['Forum ID'];

            updateComparisonChart(forumsData);

            const topChartsContainer = document.getElementById('top-charts-container');
            for (let i = 0; i < 3; i++) {
                const chartContainer = document.createElement('div');
                chartContainer.className = 'top-chart';
                chartContainer.id = `top-chart-${i + 1}`;
                topChartsContainer.appendChild(chartContainer);
                createChart(chartContainer.id, sortedForums[i]);
            }

            forumSelector1.addEventListener('change', () => updateComparisonChart(forumsData));
            forumSelector2.addEventListener('change', () => updateComparisonChart(forumsData));
        });
}

function createChart(containerId, forum) {
    Highcharts.chart(containerId, {
        chart: {
            polar: true,
            type: 'line'
        },
        title: {
            text: `Forum ${forum['Forum ID']} - Qualité: ${parseFloat(forum['Quality Score (%)']).toFixed(2)}%`
        },
        xAxis: {
            categories: [
                "Temps d'interaction total", "Temps d'interaction utilisateur",
                "Pourcentage moyen d'interactions", "Nombre de leaders",
                "Nombre de réactifs"
            ],
            tickmarkPlacement: 'on',
            lineWidth: 0
        },
        yAxis: {
            min: 0,
            max: 100
        },
        series: [{
            name: `Forum ${forum['Forum ID']}`,
            data: [
                parseFloat(forum['Total Interaction Time (%)']),
                parseFloat(forum['User Interaction Time (%)']),
                parseFloat(forum['Average Interactions Percentage (%)']),
                parseFloat(forum['Leaders Count (%)']),
                parseFloat(forum['Reactives Count (%)'])
            ]
        }]
    });
}

function updateComparisonChart(forumsData) {
    const forumId1 = document.getElementById('forum-selector-1').value;
    const forumId2 = document.getElementById('forum-selector-2').value;

    const forum1 = forumsData.find(f => f['Forum ID'] === forumId1);
    const forum2 = forumsData.find(f => f['Forum ID'] === forumId2);

    Highcharts.chart('chart-main', {
        chart: {
            polar: true,
            type: 'line'
        },
        title: {
            text: `Comparaison Forum ${forum1['Forum ID']} et Forum ${forum2['Forum ID']}`
        },
        xAxis: {
            categories: [
                "Temps d'interaction total", "Temps d'interaction utilisateur",
                "Pourcentage moyen d'interactions", "Nombre de leaders",
                "Nombre de réactifs"
            ]
        },
        yAxis: {
            min: 0,
            max: 100
        },
        series: [{
            name: `Forum ${forum1['Forum ID']}`,
            data: [
                parseFloat(forum1['Total Interaction Time (%)']),
                parseFloat(forum1['User Interaction Time (%)']),
                parseFloat(forum1['Average Interactions Percentage (%)']),
                parseFloat(forum1['Leaders Count (%)']),
                parseFloat(forum1['Reactives Count (%)'])
            ]
        }, {
            name: `Forum ${forum2['Forum ID']}`,
            data: [
                parseFloat(forum2['Total Interaction Time (%)']),
                parseFloat(forum2['User Interaction Time (%)']),
                parseFloat(forum2['Average Interactions Percentage (%)']),
                parseFloat(forum2['Leaders Count (%)']),
                parseFloat(forum2['Reactives Count (%)'])
            ]
        }]
    });
}

loadAndCreateCharts();
</script>

</body>
</html>
